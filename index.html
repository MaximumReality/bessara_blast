<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Mochkil's Snack Attack | Maximum Reality</title>

<style>
:root {
    --neon-green: #39FF14;
    --neon-pink: #FF00FF;
    --neon-blue: #00FFEF;
}

body {
    margin: 0;
    padding: 0;
    background: #000 url('mochkils_kitchen.png') center/cover fixed;
    height: 100vh;
    width: 100vw;
    overflow: hidden;
    font-family: 'Courier New', Courier, monospace;
}

/* SCREENS */
#welcome-screen, #game-screen {
    position: absolute;
    inset: 0;
}

#welcome-screen {
    background: rgba(0,0,0,0.75);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 100;
}

/* UI */
#ui {
    position: absolute;
    top: 40px;
    left: 20px;
    color: var(--neon-green);
    font-size: 18px;
    font-weight: bold;
    text-shadow: 2px 2px #000;
    z-index: 10;
    pointer-events: none;
}

#progress-container {
    position: absolute;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    width: 70%;
    height: 14px;
    border: 2px solid var(--neon-blue);
    border-radius: 10px;
    background: rgba(0,255,239,0.1);
    z-index: 10;
    display: none;
}

#progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, var(--neon-blue), var(--neon-green));
    border-radius: 8px;
    transition: width 0.2s;
}

/* BUTTONS */
.menu-btn {
    width: 280px;
    padding: 20px;
    margin: 10px;
    font-size: 20px;
    font-weight: bold;
    border: none;
    border-radius: 15px;
    cursor: pointer;
    box-shadow: 0 0 15px var(--neon-green);
}

.btn-infinite {
    background: var(--neon-blue);
    box-shadow: 0 0 15px var(--neon-blue);
}

#home-btn {
    position: absolute;
    top: 40px;
    right: 20px;
    padding: 10px 15px;
    background: var(--neon-pink);
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
    display: none;
    z-index: 20;
}

canvas {
    position: absolute;
    inset: 0;
    z-index: 5;
}

#victory-video {
    position: fixed;
    inset: 0;
    object-fit: cover;
    background: #000;
    display: none;
    z-index: 1000;
}

h1 {
    color: var(--neon-pink);
    text-shadow: 3px 3px #000;
    text-align: center;
}
</style>
</head>

<body>

<!-- WELCOME -->
<div id="welcome-screen">
    <h1>MAXIMUM REALITY<br>SNACK ATTACK</h1>
    <button class="menu-btn" onclick="startGame('levels')">GOAL MODE (1000)</button>
    <button class="menu-btn btn-infinite" onclick="startGame('infinite')">INFINITE CHAOS</button>
    <button class="menu-btn" onclick="window.location.href='https://MaximumReality.xyz'">üè† MAIN SITE</button>
</div>

<!-- GAME -->
<div id="game-screen" style="display:none;">
    <div id="ui">
        BASIRAH: <span id="score">0</span><br>
        ‚≠ê <span id="stars"></span><br>
        üèÜ BEST: <span id="best">0</span>
    </div>

    <div id="progress-container"><div id="progress-bar"></div></div>
    <button id="home-btn" onclick="goHome()">üè† HOME</button>
    <canvas id="gameCanvas"></canvas>
</div>

<video id="victory-video" playsinline>
    <source src="victory_scene.MP4" type="video/MP4">
</video>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = innerWidth;
canvas.height = innerHeight;

const scoreEl = document.getElementById('score');
const starsEl = document.getElementById('stars');
const bestEl = document.getElementById('best');
const progressBar = document.getElementById('progress-bar');
const progressCont = document.getElementById('progress-container');
const welcome = document.getElementById('welcome-screen');
const game = document.getElementById('game-screen');
const homeBtn = document.getElementById('home-btn');
const victory = document.getElementById('victory-video');

const chefHappy = new Image(); chefHappy.src = 'mochkil_happy.png';
const chefChaos = new Image(); chefChaos.src = 'mochkil_chaos.png';
const azul = new Image(); azul.src = 'azul_insight.png';

const music = new Audio('snack_attack_theme.mp3');
music.loop = true;

let score = 0;
let best = localStorage.getItem('mochkil_best') || 0;
bestEl.textContent = best;

let chefX = canvas.width / 2;
let items = [];
let gameOn = false;
let mode = 'levels';
let stars = 0;
let sugar = false;

const goal = 1000;
const floorY = canvas.height - 150;

class Item {
    constructor(type){
        this.type = type;
        this.x = Math.random() * (canvas.width - 60) + 30;
        this.y = -40;
        this.speed = type === 'bean' ? 5 : 8;
    }
    update(){
        this.y += this.speed;
        if(this.y > floorY - 100 && this.y < floorY &&
           this.x > chefX - 60 && this.x < chefX + 60){

            if(this.type === 'bean'){
                score += 10;
                scoreEl.textContent = score;
                if(score > best){
                    best = score;
                    bestEl.textContent = best;
                    localStorage.setItem('mochkil_best', best);
                }
                if(mode === 'levels'){
                    progressBar.style.width = Math.min(score / goal * 100, 100) + '%';
                }
                if(score % 200 === 0){
                    stars++;
                    starsEl.textContent = '‚≠ê'.repeat(stars);
                }
                if(mode === 'levels' && score >= goal){
                    win();
                }
            } else {
                sugar = true;
                canvas.style.filter = 'blur(8px) hue-rotate(180deg)';
                setTimeout(()=>{
                    sugar = false;
                    canvas.style.filter = 'none';
                }, 2000);
            }
            this.y = canvas.height + 100;
        }
    }
    draw(){
        if(this.type === 'bean'){
            ctx.fillStyle = '#98FB98';
            ctx.beginPath();
            ctx.ellipse(this.x,this.y,18,12,0,0,Math.PI*2);
            ctx.fill();
        } else {
            ctx.font = '40px Arial';
            ctx.fillText('üç™', this.x-20, this.y);
        }
    }
}

function startGame(m){
    mode = m;
    score = 0;
    stars = 0;
    items = [];
    scoreEl.textContent = '0';
    starsEl.textContent = '';
    progressBar.style.width = '0%';

    welcome.style.display = 'none';
    game.style.display = 'block';
    homeBtn.style.display = 'block';
    progressCont.style.display = m === 'levels' ? 'block' : 'none';

    music.currentTime = 0;
    music.play();
    gameOn = true;
    loop();
}

function goHome(){
    gameOn = false;
    music.pause();
    game.style.display = 'none';
    welcome.style.display = 'flex';
    homeBtn.style.display = 'none';
}

function win(){
    gameOn = false;
    music.pause();
    victory.style.display = 'block';
    victory.play();
    victory.onended = () => location.reload();
}

canvas.addEventListener('mousemove', e => chefX = e.clientX);
canvas.addEventListener('touchmove', e => {
    e.preventDefault();
    chefX = e.touches[0].clientX;
},{passive:false});

function loop(){
    if(!gameOn) return;
    ctx.clearRect(0,0,canvas.width,canvas.height);

    if(Math.random() < 0.05) items.push(new Item('bean'));
    if(Math.random() < 0.01) items.push(new Item('cookie'));

    items.forEach(i => { i.update(); i.draw(); });

    const sprite = sugar ? chefChaos : chefHappy;
    if(sprite.complete){
        ctx.drawImage(sprite, chefX-75, floorY-130, 150,150);
    }

    requestAnimationFrame(loop);
}
</script>
</body>
</html>
